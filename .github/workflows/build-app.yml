name: Compilar Aplicación para Windows y Mac

on: [push]

jobs:
  build-apps:
    strategy:
      matrix:
        os: [macos-latest, windows-latest]
    
    runs-on: ${{ matrix.os }}

    steps:
      - name: Descargar el código
        uses: actions/checkout@v4

      - name: Configurar Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Instalar dependencias
        run: |
          python -m pip install --upgrade pip
          pip install pyinstaller tkcalendar reportlab pillow pymupdf

      - name: Compilar App (Windows)
        if: matrix.os == 'windows-latest'
        run: |
          pyinstaller --noconfirm --onefile --windowed --name "BarbateCFApp" ^
          --add-data "data;data" ^
          --add-data "icons;icons" ^
          --add-data "club_logo.png;." ^
          --add-data "player_red_base.png;." ^
          --add-data "player_yellow_base.png;." ^
          --add-data "arialbd.ttf;." ^
          --add-data "logo.ico;." ^
          main.py
      
      - name: Compilar App (macOS)
        if: matrix.os == 'macos-latest'
        run: |
          pyinstaller --noconfirm --onefile --windowed --name "BarbateCFApp" \
          --add-data "data:data" \
          --add-data "icons:icons" \
          --add-data "club_logo.png:." \
          --add-data "player_red_base.png:." \
          --add-data "player_yellow_base.png:." \
          --add-data "arialbd.ttf:." \
          --add-data "logo.ico:." \
          main.py

      - name: Subir artefacto (Windows)
        if: matrix.os == 'windows-latest'
        uses: actions/upload-artifact@v4
        with:
          name: BarbateCFApp-Windows
          path: dist/BarbateCFApp.exe

      - name: Subir artefacto (macOS)
        if: matrix.os == 'macOS'
        uses: actions/upload-artifact@v4
        with:
          name: BarbateCFApp-macOS
          path: dist/BarbateCFApp.app